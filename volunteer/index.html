<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HHYC Volunteer Portal</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(90deg, #1e3a8a, #3b82f6);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 { font-size: 28px; font-weight: 300; margin-bottom: 10px; }
        .header p { opacity: 0.9; font-size: 16px; }

        .volunteer-portal { display: none; padding: 40px; }

        .volunteer-info {
            background: #f9fafb;
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 30px;
        }

        .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px; }
        .form-group { margin-bottom: 20px; }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #374151;
            font-size: 14px;
        }

        input {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            font-size: 14px;
        }

        .btn {
            background: linear-gradient(90deg, #3b82f6, #1d4ed8);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
        }

        .btn:hover { transform: translateY(-2px); }

        .task-item {
            background: white;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 15px;
        }

        .teammates-section {
            margin-bottom: 15px;
            padding: 15px;
            background: #f0f9ff;
            border-radius: 8px;
            border-left: 4px solid #3b82f6;
        }

        .teammates-label {
            font-size: 13px;
            font-weight: 600;
            color: #1e40af;
            margin-bottom: 8px;
        }

        .login-overlay {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .login-modal {
            background: white;
            padding: 40px;
            border-radius: 15px;
            width: 90%;
            max-width: 400px;
            text-align: center;
        }

        .error-message, .success-message {
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            display: none;
        }

        .error-message { background: #dc2626; color: white; }
        .success-message { background: #10b981; color: white; }

        .event-card {
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 25px;
        }

        @media (max-width: 768px) {
            .form-row { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <!-- Login Overlay -->
    <div id="loginOverlay" class="login-overlay">
        <div class="login-modal">
            <h2>Volunteer Access Required</h2>
            <div class="form-group">
                <label for="gateCode">Enter Gate Code:</label>
                <input type="password" id="gateCode" placeholder="Enter gate code">
            </div>
            <button class="btn" onclick="volunteerLogin()">Enter Portal</button>
            <div id="loginError" class="error-message">Incorrect gate code. Please try again.</div>
        </div>
    </div>

    <div class="container">
        <div class="header">
            <h1>ü§ù Volunteer Portal</h1>
            <p>Sign up for specific tasks within club events</p>
        </div>

        <div id="volunteerPortal" class="volunteer-portal">
            <div id="successMessage" class="success-message"></div>
            <div id="errorMessage" class="error-message"></div>

            <div class="volunteer-info">
                <h2 style="color: #1e3a8a; margin-bottom: 20px;">My Volunteer Information</h2>
                <div class="form-row">
                    <div class="form-group">
                        <label for="volunteerName">Your Name:</label>
                        <input type="text" id="volunteerName" placeholder="Enter your full name">
                    </div>
                    <div class="form-group">
                        <label for="volunteerEmail">Email:</label>
                        <input type="email" id="volunteerEmail" placeholder="your.email@example.com">
                    </div>
                </div>
                <div class="form-group">
                    <label for="volunteerPhone">Phone:</label>
                    <input type="tel" id="volunteerPhone" placeholder="(555) 123-4567">
                </div>
                <button class="btn" onclick="saveVolunteerInfo()">Save My Information</button>
            </div>

            <div class="events-section">
                <h2 style="color: #1e3a8a; margin-bottom: 25px;">Available Events</h2>
                <div id="eventsList"></div>
            </div>
        </div>
    </div>

    <script>
        let events = JSON.parse(localStorage.getItem('hhyc_volunteer_data')) || [];

        function volunteerLogin() {
            const gateCode = document.getElementById('gateCode').value;
            if (gateCode === '1957') {
                document.getElementById('loginOverlay').style.display = 'none';
                document.getElementById('volunteerPortal').style.display = 'block';
                loadVolunteerInfo();
                loadEvents();
            } else {
                document.getElementById('loginError').style.display = 'block';
                setTimeout(() => {
                    document.getElementById('loginError').style.display = 'none';
                }, 3000);
            }
        }

        function loadVolunteerInfo() {
            const volunteerInfo = localStorage.getItem('hhyc_volunteer_info');
            if (volunteerInfo) {
                const info = JSON.parse(volunteerInfo);
                document.getElementById('volunteerName').value = info.name || '';
                document.getElementById('volunteerEmail').value = info.email || '';
                document.getElementById('volunteerPhone').value = info.phone || '';
            }
        }

        function saveVolunteerInfo() {
            const name = document.getElementById('volunteerName').value.trim();
            const email = document.getElementById('volunteerEmail').value.trim();
            const phone = document.getElementById('volunteerPhone').value.trim();

            if (!name || !email || !phone) {
                showMessage('Please fill in all fields.', 'error');
                return;
            }

            localStorage.setItem('hhyc_volunteer_info', JSON.stringify({ name, email, phone }));
            showMessage('Your information has been saved successfully!', 'success');
        }

        function formatVolunteerName(fullName) {
            if (!fullName) return '';
            const parts = fullName.trim().split(' ');
            if (parts.length === 1) return parts[0];
            return parts[0] + ' ' + parts[parts.length - 1].charAt(0) + '.';
        }

        function loadEvents() {
            const eventsList = document.getElementById('eventsList');

            if (events.length === 0) {
                eventsList.innerHTML = '<div style="text-align: center; padding: 60px; color: #6b7280;"><h3>No events available</h3><p>Check back later for volunteer opportunities!</p></div>';
                return;
            }

            eventsList.innerHTML = events.map(event => {
                const eventDate = new Date(event.date);
                if (eventDate < new Date().setHours(0, 0, 0, 0)) return '';

                return `
                    <div class="event-card">
                        <h3 style="color: #1e3a8a; margin-bottom: 10px;">${event.name}</h3>
                        <p style="color: #6b7280; margin-bottom: 15px;">üìÖ ${eventDate.toLocaleDateString()} | üïê ${event.startTime} - ${event.endTime}</p>
                        <p style="margin-bottom: 25px;">${event.description}</p>

                        <h4 style="color: #374151; margin-bottom: 15px;">Volunteer Opportunities</h4>
                        ${event.tasks.map(task => {
                            const signedUp = task.volunteers.length;
                            const needed = task.volunteersNeeded;
                            const teammates = task.volunteers.map(v => formatVolunteerName(v.name)).join(', ');
                            const isFull = signedUp >= needed;

                            return `
                                <div class="task-item">
                                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                                        <strong>${task.description}</strong>
                                        <span style="background: ${isFull ? '#dcfce7' : '#dbeafe'}; color: ${isFull ? '#166534' : '#1e40af'}; padding: 4px 12px; border-radius: 12px; font-size: 12px;">
                                            üë• ${signedUp}/${needed} volunteers${isFull ? ' ‚úì' : ''}
                                        </span>
                                    </div>

                                    <div class="teammates-section">
                                        <div class="teammates-label">ü§ù Working with:</div>
                                        <div style="color: #374151; font-size: 14px;">
                                            ${teammates || 'Be the first to sign up!'}
                                        </div>
                                    </div>

                                    ${isFull ? 
                                        '<button class="btn" disabled style="opacity: 0.5;">Task Full</button>' :
                                        `<button class="btn" onclick="signUpForTask(${event.id}, ${task.id})">Sign Up for This Task</button>`
                                    }
                                </div>
                            `;
                        }).join('')}
                    </div>
                `;
            }).filter(html => html).join('');
        }

        function signUpForTask(eventId, taskId) {
            const name = document.getElementById('volunteerName').value.trim();
            const email = document.getElementById('volunteerEmail').value.trim();
            const phone = document.getElementById('volunteerPhone').value.trim();

            if (!name || !email || !phone) {
                showMessage('Please fill in your volunteer information before signing up.', 'error');
                return;
            }

            const event = events.find(e => e.id == eventId);
            const task = event.tasks.find(t => t.id == taskId);

            if (task.volunteers.some(v => v.email === email)) {
                showMessage('You are already signed up for this task!', 'error');
                return;
            }

            if (confirm(`Sign up for "${task.description}" at ${event.name}?`)) {
                task.volunteers.push({ name, email, phone });
                localStorage.setItem('hhyc_volunteer_data', JSON.stringify(events));
                showMessage(`Successfully signed up for "${task.description}"!`, 'success');
                loadEvents();
            }
        }

        function showMessage(message, type) {
            const messageElement = document.getElementById(type + 'Message');
            messageElement.textContent = message;
            messageElement.style.display = 'block';
            setTimeout(() => messageElement.style.display = 'none', 5000);
        }

        // Add sample data if none exists
        if (events.length === 0) {
            events.push({
                id: 1,
                name: "Annual Holiday Party",
                date: "2024-12-15",
                startTime: "18:00",
                endTime: "22:00",
                description: "Join us for our annual holiday celebration with dinner, dancing, and door prizes!",
                tasks: [
                    {
                        id: 1,
                        description: "Setup tables and chairs (Start: 2:00 PM)",
                        volunteersNeeded: 3,
                        volunteers: [
                            { name: "Glenn F.", email: "glenn@example.com", phone: "(555) 123-4567" },
                            { name: "Justin P.", email: "justin@example.com", phone: "(555) 234-5678" }
                        ]
                    },
                    {
                        id: 2,
                        description: "Food service and cleanup (Start: 5:00 PM)",
                        volunteersNeeded: 4,
                        volunteers: [
                            { name: "Sarah M.", email: "sarah@example.com", phone: "(555) 345-6789" }
                        ]
                    },
                    {
                        id: 3,
                        description: "Registration and check-in (Start: 5:30 PM)",
                        volunteersNeeded: 2,
                        volunteers: []
                    }
                ]
            });
            localStorage.setItem('hhyc_volunteer_data', JSON.stringify(events));
        }
    </script>
</body>
</html>