<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HHYC Volunteer Admin</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f0f8ff;
        }
        .header {
            background-color: #1e3a8a;
            color: white;
            padding: 20px;
            text-align: center;
            margin-bottom: 30px;
            border-radius: 8px;
        }
        .login-container {
            max-width: 400px;
            margin: 100px auto;
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        .admin-panel {
            display: none;
        }
        .section {
            background: white;
            margin: 20px 0;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .section h2 {
            color: #1e3a8a;
            border-bottom: 2px solid #1e3a8a;
            padding-bottom: 10px;
        }
        .form-group {
            margin: 15px 0;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        input, textarea, select {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            box-sizing: border-box;
        }
        button {
            background-color: #1e3a8a;
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px 5px 5px 0;
        }
        button:hover {
            background-color: #1e40af;
        }
        .danger-btn {
            background-color: #dc2626;
        }
        .danger-btn:hover {
            background-color: #b91c1c;
        }
        .event-item {
            border: 1px solid #ddd;
            margin: 10px 0;
            padding: 15px;
            border-radius: 8px;
            background-color: #f9f9f9;
        }
        .task-item {
            background-color: #e0f2fe;
            margin: 10px 0;
            padding: 12px;
            border-left: 4px solid #1e3a8a;
            border-radius: 4px;
        }
        .volunteer-tag {
            display: inline-block;
            background-color: #10b981;
            color: white;
            padding: 4px 8px;
            margin: 2px;
            border-radius: 12px;
            font-size: 12px;
        }
        .logout-btn {
            position: absolute;
            top: 20px;
            right: 20px;
            background-color: #6b7280;
        }
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
        }
        .modal-content {
            background-color: white;
            margin: 15% auto;
            padding: 20px;
            border-radius: 8px;
            width: 80%;
            max-width: 500px;
        }
    </style>
</head>
<body>
    <!-- Login Form -->
    <div id="loginContainer" class="login-container">
        <h2 style="text-align: center; color: #1e3a8a;">Admin Login</h2>
        <div class="form-group">
            <label for="adminPassword">Admin Password:</label>
            <input type="password" id="adminPassword" placeholder="Enter admin password">
        </div>
        <button onclick="adminLogin()" style="width: 100%;">Login</button>
        <p id="loginError" style="color: red; display: none;">Invalid password!</p>
        <div style="text-align: center; margin-top: 20px;">
            <a href="index.html" style="color: #1e3a8a;">‚Üê Back to Volunteer Portal</a>
        </div>
    </div>

    <!-- Admin Panel -->
    <div id="adminPanel" class="admin-panel">
        <button class="logout-btn" onclick="logout()">Logout</button>

        <div class="header">
            <h1>üèÜ Hidden Harbor Yacht Club</h1>
            <h2>Volunteer Management - Admin Panel</h2>
        </div>

        <!-- Create Event Section -->
        <div class="section">
            <h2>Create New Event</h2>
            <div class="form-group">
                <label for="eventName">Event Name:</label>
                <input type="text" id="eventName" placeholder="e.g., Lobster Bake 2025">
            </div>
            <div class="form-group">
                <label for="eventDate">Event Date:</label>
                <input type="date" id="eventDate">
            </div>
            <button onclick="createEvent()">Create Event</button>
        </div>

        <!-- Manage Events Section -->
        <div class="section">
            <h2>Manage Events</h2>
            <div id="eventsContainer">
                <!-- Events will be loaded here -->
            </div>
        </div>
    </div>

    <!-- Add Task Modal -->
    <div id="taskModal" class="modal">
        <div class="modal-content">
            <h3>Add New Task</h3>
            <div class="form-group">
                <label for="taskDescription">Task Description:</label>
                <textarea id="taskDescription" rows="3" placeholder="e.g., Setup tables and chairs (Start: 2:00 PM)"></textarea>
            </div>
            <div class="form-group">
                <label for="volunteersNeeded">Volunteers Needed:</label>
                <input type="number" id="volunteersNeeded" min="1" value="1">
            </div>
            <button onclick="saveTask()">Add Task</button>
            <button onclick="closeTaskModal()" style="background-color: #6b7280;">Cancel</button>
        </div>
    </div>

    <!-- Confirmation Modal -->
    <div id="confirmModal" class="modal">
        <div class="modal-content">
            <h3 id="confirmTitle">Confirm Action</h3>
            <p id="confirmMessage">Are you sure you want to proceed?</p>
            <input type="password" id="confirmPassword" placeholder="Enter admin password to confirm" style="margin: 10px 0;">
            <button id="confirmBtn" onclick="executeConfirmedAction()">Confirm</button>
            <button onclick="closeConfirmModal()" style="background-color: #6b7280;">Cancel</button>
        </div>
    </div>

    <script>
        let events = [];
        let currentEventId = null;
        let pendingAction = null;

        // Load data from localStorage
        function loadData() {
            const stored = localStorage.getItem('hhyc_volunteer_data');
            if (stored) {
                events = JSON.parse(stored);
            } else {
                // Initialize with sample data
                initializeSampleData();
            }
        }

        // Save data to localStorage
        function saveData() {
            localStorage.setItem('hhyc_volunteer_data', JSON.stringify(events));
        }

        // Initialize with sample data
        function initializeSampleData() {
            events = [{
                id: 1,
                name: "Lobster Bake 2025",
                date: "2025-08-30",
                tasks: [
                    {
                        id: 1,
                        eventId: 1,
                        description: "Setup tables and chairs (Start: 2:00 PM)",
                        volunteersNeeded: 3,
                        volunteers: []
                    },
                    {
                        id: 2,
                        eventId: 1,
                        description: "Kitchen prep and food preparation",
                        volunteersNeeded: 2,
                        volunteers: []
                    },
                    {
                        id: 3,
                        eventId: 1,
                        description: "Cooking and grilling (Start: 4:00 PM)",
                        volunteersNeeded: 4,
                        volunteers: []
                    },
                    {
                        id: 4,
                        eventId: 1,
                        description: "Serving food and beverages (Start: 5:00 PM)",
                        volunteersNeeded: 6,
                        volunteers: []
                    },
                    {
                        id: 5,
                        eventId: 1,
                        description: "Cleanup and breakdown (Start: 8:00 PM)",
                        volunteersNeeded: 4,
                        volunteers: []
                    }
                ]
            }];
            saveData();
        }

        // Admin login
        function adminLogin() {
            const password = document.getElementById('adminPassword').value;
            if (password === '7591') {
                document.getElementById('loginContainer').style.display = 'none';
                document.getElementById('adminPanel').style.display = 'block';
                loadData();
                displayEvents();
            } else {
                document.getElementById('loginError').style.display = 'block';
            }
        }

        // Logout
        function logout() {
            document.getElementById('loginContainer').style.display = 'block';
            document.getElementById('adminPanel').style.display = 'none';
            document.getElementById('adminPassword').value = '';
            document.getElementById('loginError').style.display = 'none';
        }

        // Create new event
        function createEvent() {
            const name = document.getElementById('eventName').value.trim();
            const date = document.getElementById('eventDate').value;

            if (!name || !date) {
                alert('Please fill in all fields');
                return;
            }

            const newEvent = {
                id: Date.now(),
                name: name,
                date: date,
                tasks: []
            };

            events.push(newEvent);
            saveData();
            displayEvents();

            // Clear form
            document.getElementById('eventName').value = '';
            document.getElementById('eventDate').value = '';
        }

        // Display all events
        function displayEvents() {
            const container = document.getElementById('eventsContainer');
            container.innerHTML = '';

            events.sort((a, b) => new Date(a.date) - new Date(b.date));

            events.forEach(event => {
                const eventDiv = document.createElement('div');
                eventDiv.className = 'event-item';
                eventDiv.innerHTML = `
                    <h3>${event.name}</h3>
                    <p><strong>Date:</strong> ${new Date(event.date).toLocaleDateString()}</p>
                    <button onclick="showAddTaskModal(${event.id})">Add Task</button>
                    <button class="danger-btn" onclick="showDeleteConfirmation('event', ${event.id}, '${event.name}')">Delete Event</button>
                    <div id="tasks-${event.id}">
                        ${displayTasks(event.tasks, event.id)}
                    </div>
                `;
                container.appendChild(eventDiv);
            });
        }

        // Display tasks for an event
        function displayTasks(tasks, eventId) {
            if (tasks.length === 0) {
                return '<p style="color: #666; font-style: italic;">No tasks added yet.</p>';
            }

            return tasks.map(task => `
                <div class="task-item">
                    <h4>${task.description}</h4>
                    <p><strong>Volunteers needed:</strong> ${task.volunteersNeeded}</p>
                    <p><strong>Volunteers signed up:</strong> ${task.volunteers.length}</p>
                    <div>
                        ${task.volunteers.map(v => `<span class="volunteer-tag">${v.name}</span>`).join('')}
                    </div>
                    <button class="danger-btn" onclick="showDeleteConfirmation('task', ${task.id}, '${task.description}', ${eventId})">Delete Task</button>
                </div>
            `).join('');
        }

        // Show add task modal
        function showAddTaskModal(eventId) {
            currentEventId = eventId;
            document.getElementById('taskModal').style.display = 'block';
        }

        // Close task modal
        function closeTaskModal() {
            document.getElementById('taskModal').style.display = 'none';
            document.getElementById('taskDescription').value = '';
            document.getElementById('volunteersNeeded').value = '1';
            currentEventId = null;
        }

        // Save new task
        function saveTask() {
            const description = document.getElementById('taskDescription').value.trim();
            const volunteersNeeded = parseInt(document.getElementById('volunteersNeeded').value);

            if (!description || volunteersNeeded < 1) {
                alert('Please fill in all fields with valid values');
                return;
            }

            const event = events.find(e => e.id === currentEventId);
            if (event) {
                const newTask = {
                    id: Date.now(),
                    eventId: currentEventId,
                    description: description,
                    volunteersNeeded: volunteersNeeded,
                    volunteers: []
                };

                event.tasks.push(newTask);
                saveData();
                displayEvents();
                closeTaskModal();
            }
        }

        // Show delete confirmation
        function showDeleteConfirmation(type, id, name, eventId = null) {
            document.getElementById('confirmTitle').textContent = `Delete ${type.charAt(0).toUpperCase() + type.slice(1)}`;
            document.getElementById('confirmMessage').textContent = `Are you sure you want to delete "${name}"?`;
            document.getElementById('confirmPassword').value = '';

            pendingAction = { type, id, eventId };
            document.getElementById('confirmModal').style.display = 'block';
        }

        // Close confirmation modal
        function closeConfirmModal() {
            document.getElementById('confirmModal').style.display = 'none';
            pendingAction = null;
        }

        // Execute confirmed action
        function executeConfirmedAction() {
            const password = document.getElementById('confirmPassword').value;
            if (password !== '7591') {
                alert('Invalid password!');
                return;
            }

            if (!pendingAction) return;

            if (pendingAction.type === 'event') {
                events = events.filter(e => e.id !== pendingAction.id);
            } else if (pendingAction.type === 'task') {
                const event = events.find(e => e.id === pendingAction.eventId);
                if (event) {
                    event.tasks = event.tasks.filter(t => t.id !== pendingAction.id);
                }
            }

            saveData();
            displayEvents();
            closeConfirmModal();
        }

        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            loadData();
        });
    </script>
</body>
</html>